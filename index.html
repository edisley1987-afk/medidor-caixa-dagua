<script>
async function atualizarLeituras() {
  try {
    const resposta = await fetch("https://webhook.site/6587d8ee-896b-4597-aef4-e87aaf3a95d2");
    const texto = await resposta.text();
    const jsonStr = texto.match(/\{[\s\S]*\}/g);
    if (!jsonStr) return;

    const dados = JSON.parse(jsonStr[jsonStr.length - 1]);

    const mapa = {
      "Reservatorio_Elevador_current": "Reservatorio_Elevador_current",
      "Reservatorio_Osmose_current": "Reservatorio_Osmose_current",
      "Reservatorio_CME_current": "Reservatorio_CME_current",
      "Agua_Abrandada_current": "Reservatorio_Abrandada_current"
    };

    for (let key in mapa) {
      const el = document.getElementById(mapa[key]);
      const item = dados.find(d => d.ref === key);
      if (el && item) {
        el.textContent = (item.value * 100).toFixed(1) + "%";
      }
    }
  } catch (erro) {
    console.error("Erro ao buscar dados:", erro);
  }
}

// Atualiza a cada 10 segundos
setInterval(atualizarLeituras, 10000);
atualizarLeituras();
</script>
